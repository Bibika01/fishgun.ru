var signForm={init:function(){signForm.setSelectors(),signForm.setVariables(),signForm.initializeSignForm(),signForm.setEventListeners()},setSelectors:function(){signForm.elem=document.querySelector(".sign-form"),signForm.closeElem=document.querySelector(".sign-form-close"),signForm.signInElem=document.querySelector(".sign-form-signin"),signForm.signUpElem=document.querySelector(".sign-form-signup"),signForm.lineElem=document.querySelector(".sign-form-line"),signForm.boxesElem=document.querySelector(".sign-form-boxes"),signForm.forgotPassElem=document.querySelector(".sign-form-forgot"),signForm.signInEmailInputElem=document.querySelector(".sign-form-signin-email"),signForm.signInEmailErrorInputElem=document.querySelector(".sign-form-signin-email-error"),signForm.signInPassInputElem=document.querySelector(".sign-form-signin-pass"),signForm.signInErrorInputElem=document.querySelector(".sign-form-signin-error"),signForm.authSignInElem=document.querySelectorAll(".auth-signin"),signForm.authSignUpElem=document.querySelectorAll(".auth-signup"),signForm.googleSignInErrorElem=document.querySelector(".sign-form-google-signin-error"),signForm.twitterSignInErrorElem=document.querySelector(".sign-form-twitter-signin-error"),signForm.recoverEmailInputElem=document.querySelector(".sign-form-recover-email"),signForm.recoverEmailErrorInputElem=document.querySelector(".sign-form-recover-email-error"),signForm.signUpEmailInputElem=document.querySelector(".sign-form-signup-email"),signForm.signUpEmailErrorInputElem=document.querySelector(".sign-form-signup-email-error"),signForm.googleSignUpErrorElem=document.querySelector(".sign-form-google-signup-error"),signForm.twitterSignUpErrorElem=document.querySelector(".sign-form-twitter-signup-error"),signForm.signInSubmitElem=document.querySelector(".sign-form-signin-submit"),signForm.signUpSubmitElem=document.querySelector(".sign-form-signup-submit"),signForm.recoverSubmitElem=document.querySelector(".sign-form-recover-submit"),signForm.resendSubmitElem=document.querySelector(".sign-form-resend-submit"),signForm.resendBeforeElem=document.querySelector(".sign-form-resend-before"),signForm.resendAfterElem=document.querySelector(".sign-form-resend-after"),signForm.signUpDisplayEmailElem=document.querySelector(".sign-form-signup-display-email"),signForm.signUpBeforeElem=document.querySelector(".sign-form-signup-before"),signForm.signUpAfterElem=document.querySelector(".sign-form-signup-after"),signForm.recoverBeforeElem=document.querySelector(".sign-form-recover-before"),signForm.recoverAfterElem=document.querySelector(".sign-form-recover-after"),signForm.recoverDisplayEmailElem=document.querySelector(".sign-form-recover-display-email"),signForm.termsElem=document.getElementById("sign-form-terms"),signForm.termsTextElem=document.querySelector(".sign-form-terms-text")},setVariables:function(){signForm.data={reason:"",email:"",pass:"",extensionsLoaded:!1,selectedOAuthButtonElem:null}},initializeSignForm:function(){signForm.focusInputElements(),signForm.openSignFormViaQuery(),window.executeSignFormCaptcha=signForm.executeSign,window.onErrorCaptcha=signForm.onErrorCaptcha},inputFocus:function(element,isEmail,focusOut){void 0===focusOut&&(focusOut=!1),core.hideElem(signForm.googleSignInErrorElem);var parent=element.parentNode;parent.children[0].classList.remove("input-label-filled"),parent.children[1].classList.remove("input-field-error"),focusOut?(parent.children[0].classList.remove("input-label-active"),parent.children[1].classList.remove("input-field-active"),""!==element.value&&(parent.children[0].classList.add("input-label-filled"),isEmail&&!core.regMail.test(element.value)&&(parent.children[2].innerHTML=_t("Enter a valid email address"),core.showElem(parent.children[2]),parent.children[1].classList.add("input-field-error")))):core.focusInput(parent)},toggleCheckBox:function(event){"a"!==event.target.tagName.toLowerCase()&&(signForm.termsElem.checked=!signForm.termsElem.checked,signForm.termsTextElem.classList.remove("error-color"))},changeSignOption:function(isSignIn,isForgot){var translateScreen,translateScreenMobile;void 0===isForgot&&(isForgot=!1),isSignIn?(isForgot&&core.regMail.test(signForm.signInEmailInputElem.value)&&(signForm.recoverEmailInputElem.value=signForm.signInEmailInputElem.value,signForm.inputFocus(signForm.recoverEmailInputElem,!0,!0)),signForm.signInElem.classList.add("sign-form-choose-active"),signForm.signUpElem.classList.remove("sign-form-choose-active"),signForm.lineElem.classList.remove("sign-form-line-right"),translateScreen=isForgot?0:-405,translateScreenMobile=isForgot?0:-window.innerWidth):(signForm.lineElem.classList.add("sign-form-line-right"),signForm.signUpElem.classList.add("sign-form-choose-active"),signForm.signInElem.classList.remove("sign-form-choose-active"),translateScreen=-810,translateScreenMobile=-2*window.innerWidth);var translateValue=window.innerWidth<640?translateScreenMobile:translateScreen;signForm.boxesElem.style.transform="translateX("+translateValue+"px)"},submit:function(event){if(EasyBit.config.isTor)core.alertDeny(_t("Access Denied"),_t("We were not able to collect identifiable information through your browser, thus we are not able to provide our services."));else if("undefined"!=typeof grecaptcha&&"function"==typeof grecaptcha.execute)if(signForm.data.reason=event.target.dataset.reason,"signin"===signForm.data.reason)signForm.data.email=signForm.signInEmailInputElem.value,signForm.data.pass=signForm.signInPassInputElem.value,core.regMail.test(signForm.data.email)?(grecaptcha.execute(),event.target.disabled=!0):(signForm.signInEmailErrorInputElem.innerHTML=_t("Enter a valid email address"),core.showElem(signForm.signInEmailErrorInputElem),signForm.signInEmailInputElem.classList.add("input-field-error"));else if("signup"===signForm.data.reason)if(signForm.data.email=signForm.signUpEmailInputElem.value,core.regMail.test(signForm.data.email)){if(!signForm.termsElem.checked)return void signForm.termsTextElem.classList.add("error-color");grecaptcha.execute(),event.target.disabled=!0}else signForm.signUpEmailErrorInputElem.innerHTML=_t("Enter a valid email address"),core.showElem(signForm.signUpEmailErrorInputElem),signForm.signUpEmailInputElem.classList.add("input-field-error");else"recover"===signForm.data.reason?(signForm.data.email=signForm.recoverEmailInputElem.value,core.regMail.test(signForm.data.email)?(grecaptcha.execute(),event.target.disabled=!0):(signForm.recoverEmailErrorInputElem.innerHTML=_t("Enter a valid email address"),core.showElem(signForm.recoverEmailErrorInputElem),signForm.recoverEmailInputElem.classList.add("input-field-error"))):"resend"===signForm.data.reason&&(signForm.data.email=signForm.signUpDisplayEmailElem.innerHTML,grecaptcha.execute());else setTimeout((function(){signForm.submit(event)}),100)},executeSign:function(token){"signup"===signForm.data.reason?(core.setActionOrderCookie(),core.fetch("/account/sign-up",{method:"POST",body:JSON.stringify({mail:signForm.data.email,token:token})}).then((function(data){if(void 0!==data.success&&data.success)signForm.signUpBeforeElem.style.display="none",signForm.signUpDisplayEmailElem.innerHTML=signForm.data.email,core.showElem(signForm.signUpAfterElem);else{var errorMessage=_t("An error occurred please contact us");void 0!==data.errorCode&&void 0!==data.errorMessage&&(errorMessage=data.errorMessage),signForm.signUpEmailErrorInputElem.innerHTML=errorMessage,core.showElem(signForm.signUpEmailErrorInputElem),signForm.signUpEmailInputElem.classList.add("input-field-error")}})).catch((function(e){return errorReport(e)})).finally((function(){signForm.resetDisabledButton()}))):"signin"===signForm.data.reason?(core.setActionOrderCookie(),core.setDevId(),core.fetch("/account/sign-in",{method:"POST",body:JSON.stringify({mail:signForm.data.email,pass:signForm.data.pass,token:token})}).then((function(data){if(void 0!==data.success&&data.success)localStorage.setItem("lg_45d3k2d","login"),window.location.reload();else{var errorMessage=_t("An error occurred please contact us");void 0!==data.errorCode&&void 0!==data.errorMessage&&(errorMessage=data.errorMessage),signForm.signInErrorInputElem.innerHTML=errorMessage,core.showElem(signForm.signInErrorInputElem)}})).catch((function(e){return errorReport(e)})).finally((function(){signForm.resetDisabledButton()}))):"recover"===signForm.data.reason?core.fetch("/account/recover-password",{method:"POST",body:JSON.stringify({mail:signForm.data.email,token:token})}).then((function(data){void 0!==data.success&&data.success?(signForm.recoverBeforeElem.style.display="none",signForm.recoverDisplayEmailElem.innerHTML=signForm.data.email,core.showElem(signForm.recoverAfterElem)):core.alert(_t("Error Occurred"),_t("If this error persists contact us"),3e3)})).catch((function(e){return errorReport(e)})).finally((function(){signForm.resetDisabledButton()})):"resend"===signForm.data.reason&&core.fetch("/account/signup-resend",{method:"POST",body:JSON.stringify({mail:signForm.data.email,token:token})}).then((function(data){void 0!==data.success&&data.success?(core.hideElem(signForm.resendBeforeElem),core.showElem(signForm.resendAfterElem)):core.alert(_t("Error Occurred"),_t("If this error persists contact us"),3e3)})).catch((function(e){return errorReport(e)})),grecaptcha.reset()},authUserInit:function(event,callback){if(EasyBit.config.isTor)core.alertDeny(_t("Access Denied"),_t("We were not able to collect identifiable information through your browser, thus we are not able to provide our services."));else{var provider=event.currentTarget.dataset.provider;EasyBit.config.isApp?callback(event.currentTarget,provider,null):"google"===provider?(authUserProvider=new firebase.auth.GoogleAuthProvider,authUserProvider.addScope("email"),callback(event.currentTarget,provider,authUserProvider)):"twitter"===provider&&(authUserProvider=new firebase.auth.TwitterAuthProvider,callback(event.currentTarget,provider,authUserProvider))}},authSignIn:function(buttonElement,provider,authUserProvider){signForm.data.selectedOAuthButtonElem=buttonElement,EasyBit.config.isApp?appInterface.sendAction(appInterface.actionMessage.signIn,provider):firebase.auth().signInWithPopup(authUserProvider).then((function(result){var token="twitter"===provider?result.credential.accessToken:result.credential.idToken,secret="twitter"===provider?result.credential.secret:"no";signForm.authSignInFetchAction(token,secret,provider)})).catch((function(e){return errorReport(e)}))},authSignUp:function(buttonElement,provider,authUserProvider){signForm.termsElem.checked?(signForm.data.selectedOAuthButtonElem=buttonElement,EasyBit.config.isApp?appInterface.sendAction(appInterface.actionMessage.signUp,provider):firebase.auth().signInWithPopup(authUserProvider).then((function(result){var token="twitter"===provider?result.credential.accessToken:result.credential.idToken,secret="twitter"===provider?result.credential.secret:"no";signForm.authSignUpFetchAction(token,secret,provider)})).catch((function(e){return errorReport(e)}))):signForm.termsTextElem.classList.add("error-color")},delegateOpenSignForm:function(event){event.target&&event.target.classList.contains("open-sign-form")&&(signForm.loadExternalScripts(),"up"===event.target.dataset.sign?signForm.changeSignOption(!1):signForm.changeSignOption(!0),signForm.openSignForm())},openSignForm:function(){signForm.elem.classList.add("visible"),signForm.elem.classList.add("sign-form-active"),setTimeout((function(){mainJs.navOpenLinesElem.style.zIndex="0"}),450)},closeSignForm:function(){signForm.elem.classList.remove("sign-form-active"),setTimeout((function(){mainJs.navOpenLinesElem.style.zIndex="12"}),450)},authSignInFetchAction:function(token,secret,provider){signForm.data.selectedOAuthButtonElem.disabled=!0,core.setActionOrderCookie(),core.setDevId(),core.fetch("/account/token-sign-in",{method:"POST",body:JSON.stringify({token:token,secret:secret,provider:provider})}).then((function(data){if(void 0!==data.success&&data.success)localStorage.setItem("lg_45d3k2d","login"),window.location.reload();else{var errorMessage=_t("An error occurred please contact us");void 0!==data.errorCode&&void 0!==data.errorMessage&&(errorMessage=data.errorMessage);var authSignInErrorElem="twitter"===provider?signForm.twitterSignInErrorElem:signForm.googleSignInErrorElem;authSignInErrorElem.innerHTML=errorMessage,core.showElem(authSignInErrorElem)}})).catch((function(e){return errorReport(e)})).finally((function(){signForm.data.selectedOAuthButtonElem.disabled=!1}))},authSignUpFetchAction:function(token,secret,provider){signForm.data.selectedOAuthButtonElem.disabled=!0,core.setActionOrderCookie(),core.setDevId(),core.fetch("/account/token-sign-up",{method:"POST",body:JSON.stringify({token:token,secret:secret,provider:provider})}).then((function(data){if(void 0!==data.success&&data.success)localStorage.setItem("lg_45d3k2d","login"),window.location.reload();else{var errorMessage=_t("Please use another method to sign up.");void 0!==data.errorCode&&void 0!==data.errorMessage&&(errorMessage=data.errorMessage);var authSignUpErrorElem="twitter"===provider?signForm.twitterSignUpErrorElem:signForm.googleSignUpErrorElem;authSignUpErrorElem.innerHTML=errorMessage,core.showElem(authSignUpErrorElem)}})).catch((function(e){return errorReport(e)})).finally((function(){signForm.data.selectedOAuthButtonElem.disabled=!1}))},focusInputElements:function(){signForm.inputFocus(signForm.signInEmailInputElem,!0,!0),signForm.inputFocus(signForm.signInPassInputElem,!1,!0),signForm.inputFocus(signForm.recoverEmailInputElem,!0,!0),signForm.inputFocus(signForm.signUpEmailInputElem,!0,!0)},openSignFormViaQuery:function(){null===core.getQuery("open-sign-form")||core.isLogged||(signForm.changeSignOption(!0),signForm.openSignForm())},loadExternalScripts:function(){signForm.data.extensionsLoaded||(core.loadScript("ext:https://www.google.com/recaptcha/api.js",signForm.recaptchaCancelObserver),EasyBit.config.isApp||core.loadScript("firebase.js",(function(){firebase.initializeApp({apiKey:"AIzaSyAn1EcietIg4nrI5_5mlZe2Ttw53is7Eww",authDomain:"signin.easybit.com",databaseURL:"https://easybit-1586517742083.firebaseio.com",projectId:"easybit-1586517742083",storageBucket:"easybit-1586517742083.appspot.com",messagingSenderId:"529242549052",appId:"1:529242549052:web:e87d7fc57912dffba2cc39"})})),signForm.data.extensionsLoaded=!0)},recaptchaCancelObserver:function(){var domObserver=new MutationObserver((function(){var iframe=document.querySelector('iframe[src^="https://www.google.com/recaptcha"][src*="bframe"]');if(iframe){var _iframe$parentNode,_iframe$parentNode$pa;domObserver.disconnect();var captchaBackground=null==(_iframe$parentNode=iframe.parentNode)||null==(_iframe$parentNode$pa=_iframe$parentNode.parentNode)?void 0:_iframe$parentNode$pa.firstChild;null==captchaBackground||captchaBackground.addEventListener("click",signForm.resetDisabledButton)}}));domObserver.observe(document.documentElement||document.body,{childList:!0,subtree:!0})},onErrorCaptcha:function(){signForm.resetDisabledButton(),core.alert("reCaptcha",_t("Check your internet connection and try again. If this error persist please reload the page and retry"),5e3)},resetDisabledButton:function(){"signup"===signForm.data.reason?signForm.signUpSubmitElem.disabled=!1:"signin"===signForm.data.reason?signForm.signInSubmitElem.disabled=!1:"recover"===signForm.data.reason&&(signForm.recoverSubmitElem.disabled=!1)},setEventListeners:function(){signForm.closeElem.addEventListener("click",(function(){signForm.closeSignForm()})),signForm.signInElem.addEventListener("click",(function(){signForm.changeSignOption(!0)})),signForm.signUpElem.addEventListener("click",(function(){signForm.changeSignOption(!1)})),signForm.forgotPassElem.addEventListener("click",(function(){signForm.changeSignOption(!0,!0)})),signForm.signInEmailInputElem.addEventListener("focus",(function(){signForm.inputFocus(signForm.signInEmailInputElem,!0)})),signForm.signInEmailInputElem.addEventListener("focusout",(function(){signForm.inputFocus(signForm.signInEmailInputElem,!0,!0)})),signForm.signInPassInputElem.addEventListener("focus",(function(){signForm.inputFocus(signForm.signInPassInputElem,!1)})),signForm.signInPassInputElem.addEventListener("focusout",(function(){signForm.inputFocus(signForm.signInPassInputElem,!1,!0)})),signForm.recoverEmailInputElem.addEventListener("focus",(function(){signForm.inputFocus(signForm.recoverEmailInputElem,!0)})),signForm.recoverEmailInputElem.addEventListener("focusout",(function(){signForm.inputFocus(signForm.recoverEmailInputElem,!0,!0)})),signForm.signUpEmailInputElem.addEventListener("focus",(function(){signForm.inputFocus(signForm.signUpEmailInputElem,!0)})),signForm.signUpEmailInputElem.addEventListener("focusout",(function(){signForm.inputFocus(signForm.signUpEmailInputElem,!0,!0)})),signForm.signInSubmitElem.addEventListener("click",(function(event){signForm.submit(event)})),signForm.signUpSubmitElem.addEventListener("click",(function(event){signForm.submit(event)})),signForm.recoverSubmitElem.addEventListener("click",(function(event){signForm.submit(event)})),signForm.resendSubmitElem.addEventListener("click",(function(event){core.preventDoubleClick(signForm.submit,3e3,event)})),signForm.termsElem.addEventListener("change",(function(){signForm.termsTextElem.classList.remove("error-color")})),signForm.termsTextElem.addEventListener("click",(function(event){signForm.toggleCheckBox(event)})),signForm.authSignInElem.forEach((function(el){el.addEventListener("click",(function(event){signForm.authUserInit(event,signForm.authSignIn)}))})),signForm.authSignUpElem.forEach((function(el){el.addEventListener("click",(function(event){signForm.authUserInit(event,signForm.authSignUp)}))})),document.addEventListener("mousedown",(function(event){signForm.elem===event.target||signForm.elem.contains(event.target)||signForm.closeSignForm()})),document.addEventListener("click",(function(event){signForm.delegateOpenSignForm(event)}))}};signForm.init();
